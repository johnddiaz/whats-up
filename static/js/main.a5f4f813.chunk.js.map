{"version":3,"sources":["components/Avatar/Avatar.module.scss","components/ChatPreview/ChatPreview.module.scss","components/Header/Header.module.scss","components/BottomSettings/BottomSettings.module.scss","components/ChatPreview/index.tsx","components/ChatPreview/ChatPreview.tsx","components/Avatar/Avatar.tsx","components/Header/Header.tsx","components/HomeHeader/index.tsx","components/HomeHeader/HomeHeader.tsx","components/InteractionMessage/index.tsx","components/InteractionMessage/InteractionMessage.tsx","__shared__/utils/dateTime.ts","components/Interaction/index.tsx","components/Interaction/Interaction.tsx","components/InteractionMessageEditor/index.tsx","components/InteractionMessageEditor/InteractionMessageEditor.tsx","components/App/layouts.tsx","components/SignIn/SignIn.tsx","__shared__/auth/useFirebaseAuth.ts","__shared__/utils/useLocalStorageState.ts","components/InteractionCreator/index.ts","components/InteractionCreator/InteractionCreator.tsx","components/InteractionBar/index.tsx","components/InteractionBar/InteractionBar.tsx","components/UserSettings/UserSettings.tsx","components/App/useLayoutStateReducer.ts","components/BottomSettings/BottomSettings.tsx","components/App/useConversationFormReducer.ts","components/App/App.tsx","__shared__/auth/withAuth.tsx","components/App/index.tsx","__shared__/hooks/useConversation.ts","components/App/useUsers.ts","__shared__/hooks/useWindowSize.ts","serviceWorkerRegistration.ts","reportWebVitals.ts","index.tsx"],"names":["module","exports","ChatPreview","props","className","styles","root","onClick","onPreviewClick","conversation","id","textRoot","style","margin","name","otherUsers","length","map","user","index","original","userName","Avatar","avatarDimensions","size","height","width","badgeDimensions","marginTop","marginLeft","src","photoURL","alt","img","badgeState","badge","backgroundColor","Header","children","HomeHeader","userState","fontSize","InteractionMessage","React","showTime","setShowTime","personClass","isSender","placementClass","borderStyling","squishAbove","squishBelow","console","log","message","createdAt","ref","newestMessageRef","display","flexDirection","undefined","showName","marginBottom","textAlign","senderName","alignSelf","side","avatarProps","marginRight","spacePlaceholder","whiteSpace","prev","content","Date","toLocaleString","MILLIS_IN_SEC","MILLIS_IN_HOUR","convertToMillis","days","hours","mins","secs","millis","runningVal","convertToSecs","Interaction","current","scrollIntoView","behavior","messages","styling","reduce","previousStyling","currentMessage","arr","currentMessageSeconds","sender","messagesWithoutAvatar","now","dayFormatter","Intl","DateTimeFormat","weekday","monthFormatter","month","userId","userStatus","statuses","currentDate","showTimelineAboveMessage","pastDate","toDateString","getTime","getHours","minutes","getMinutes","timelineDay","timelineTime","nowOffset","getSeconds","getMilliseconds","format","getDate","avatarAvailable","state","renderMessagesTimeline","InteractionMessageEditor","onChange","handleMessageChange","value","currentDraft","type","handleSend","ChatsLayout","flexGrow","flexBasis","maxWidth","InteractionLayout","SignIn","alignItems","justifyContent","showSignInPopup","config","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","useFirebaseAuth","key","useState","storedValue","localStorage","getItem","JSON","parse","setValue","useEffect","setItem","stringify","useLocalStorageState","setUser","githubProvider","setGithubProvider","googleProvider","setGoogleProvider","a","firebase","database","uid","once","val","update","displayName","set","apps","initializeApp","auth","GithubAuthProvider","GoogleAuthProvider","onAuthStateChanged","createUserInFirebaseIfNonexistent","method","selectedProvider","signInWithPopup","catch","error","InteractionCreator","handlePersonSelect","e","preventDefault","dispatchForm","payload","target","dataset","personid","formState","newConversationName","currentTarget","users","filter","minWidth","userSelect","padding","border","borderRadius","peopleForNewConversation","includes","data-personid","userStatuses","InteractionBar","back","color","cursor","icon","faArrowLeft","UserSettings","newUsername","setNewUsername","onSubmit","updateProfile","htmlFor","paddingBottom","placeholder","layoutStateReducer","action","showConversationForm","showUserSettings","BottomSettings","logOut","conversationFormReducer","person","withAuth","WrappedComponent","App","appInitiated","initialized","conversations","setConversations","conversationId","setConversationId","setMessages","db","userConversationsRefString","userConversationsRef","orderByKey","userConversationsOnce","initialConversations","lastInitialUserConversationId","exists","convoPromises","cuPromises","forEach","uc","push","Promise","all","convoResolved","cuResolved","convo","matchedConversation","find","cor","matchedConversationUsers","cur","conversationUser","child","startAfter","on","userConversationSnapshot","previousChildKey","ucKey","then","newConversationUsers","ncu","off","messagesRefString","messagesRef","messagesOnce","initialMessages","m","serverMessage","toJSON","lastInitialMessageId","messageSnapshot","clientMessage","useConversation","currentConversation","c","setStatuses","setUsers","userStatusDatabaseRef","infoConnectedRef","isOfflineForDatabase","lastChanged","ServerValue","TIMESTAMP","isOnlineForDatabase","snapshot","onDisconnect","statusRef","lastStatusKey","newStatuses","data","usersRef","lastUserKey","newUsers","changedUser","useUsers","windowSize","calculateWindowSize","window","innerWidth","setWindowSize","windowWidth","handleResize","addEventListener","removeEventListener","useWindowSize","setCurrentDraft","useReducer","useLayoutStateReducer","layoutState","layoutStateDispatch","useConversationFormReducer","conversationFormState","dispatchConversationForm","handlePreviewSelect","dispatchWithConversationId","personId","friendSnapshots","alert","conversationRef","creatorId","everythingElse","invitedBy","returnToMain","showInteractionLayout","showHomeLayout","faPlusCircle","overflow","signOut","openUserSettings","backIcon","userInfo","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById","URL","process","href","origin","fetch","headers","response","contentType","get","status","indexOf","ready","unregister","reload","checkValidServiceWorker","serviceWorkerRegistration"],"mappings":"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","file":"static/js/main.a5f4f813.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"Avatar_root__Kd_qp\",\"img\":\"Avatar_img__3V-MN\",\"badge\":\"Avatar_badge__3Amf_\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"ChatPreview_root__ZRdO5\",\"textRoot\":\"ChatPreview_textRoot__2r08x\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"Header_root__2uEfk\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"BottomSettings_root__3V1F-\"};","import ChatPreview from './ChatPreview'\r\n\r\nexport default ChatPreview\r\n","import * as React from 'react'\r\nimport styles from './ChatPreview.module.scss'\r\nimport '../../__shared__/styles.scss'\r\nimport { ClientConversation } from '../../__shared__/models'\r\n\r\ninterface Props {\r\n    conversation: ClientConversation\r\n    onPreviewClick: (id: string) => void\r\n}\r\n\r\nexport default function ChatPreview(props: Props) {\r\n    function onPreviewClick() {\r\n        props.onPreviewClick(props.conversation.id)\r\n    }\r\n\r\n    return (\r\n        <div className={styles.root} onClick={onPreviewClick}>\r\n            <div className={styles.textRoot}>\r\n                <h4 style={{ margin: '0 0 8px' }}>\r\n                    {props.conversation.name || props.conversation.id}\r\n                </h4>\r\n                <p style={{ margin: '0' }}>\r\n                    {props.conversation.otherUsers.length > 0\r\n                        ? props.conversation.otherUsers.map(\r\n                              (user, index, original) => {\r\n                                  if (\r\n                                      original.length === 1 ||\r\n                                      index === original.length - 1\r\n                                  ) {\r\n                                      return user.userName || user.id\r\n                                  } else {\r\n                                      return `${user.userName || user.id}, `\r\n                                  }\r\n                              }\r\n                          )\r\n                        : 'No users here.'}\r\n                </p>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","import * as React from 'react'\r\nimport { ClientUserStatus } from '../../__shared__/types/userStatus'\r\nimport styles from './Avatar.module.scss'\r\n\r\nexport interface AvatarProps {\r\n    photoURL: string\r\n    size?: 'sm' | 'lg'\r\n    badgeState?: ClientUserStatus['state'] | null\r\n    style?: React.CSSProperties\r\n}\r\n\r\nexport default function Avatar(props: AvatarProps) {\r\n    const avatarDimensions =\r\n        props.size === 'sm'\r\n            ? {\r\n                  height: '28px',\r\n                  width: '28px',\r\n              }\r\n            : {\r\n                  height: '36px',\r\n                  width: '36px',\r\n              }\r\n    const badgeDimensions =\r\n        props.size === 'sm'\r\n            ? {\r\n                  height: '8px',\r\n                  width: '8px',\r\n                  marginTop: '-12px',\r\n                  marginLeft: '21px',\r\n              }\r\n            : {\r\n                  height: '11px',\r\n                  width: '11px',\r\n                  marginTop: '-14px',\r\n                  marginLeft: '24px',\r\n              }\r\n    return (\r\n        <div\r\n            className={styles.root}\r\n            style={{ ...avatarDimensions, ...props.style }}\r\n        >\r\n            <img\r\n                src={props.photoURL}\r\n                alt=\"profile pic\"\r\n                className={styles.img}\r\n                style={avatarDimensions}\r\n            />\r\n            {props.badgeState && (\r\n                <div\r\n                    className={styles.badge}\r\n                    style={{\r\n                        backgroundColor:\r\n                            props.badgeState === 'online'\r\n                                ? '#57ba14'\r\n                                : '#f9fff5',\r\n                        ...badgeDimensions,\r\n                    }}\r\n                ></div>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n","import * as React from 'react'\r\nimport styles from './Header.module.scss'\r\n\r\ninterface Props {\r\n    children?: React.ReactNode\r\n}\r\n\r\nexport default function Header(props: Props) {\r\n    return <header className={styles.root}>{props.children}</header>\r\n}\r\n","import HomeHeader from './HomeHeader'\r\n\r\nexport default HomeHeader\r\n","import * as React from 'react'\r\nimport firebase from 'firebase'\r\nimport Avatar from '../Avatar'\r\n// import styles from './HomeHeader.module.scss'\r\nimport Header from '../Header'\r\n\r\ninterface Props {\r\n    user: firebase.User | null\r\n    userState: 'online' | 'offline' | null\r\n}\r\n\r\nexport default function HomeHeader(props: Props) {\r\n    return (\r\n        <Header>\r\n            {props.user?.photoURL && (\r\n                <Avatar\r\n                    photoURL={props.user.photoURL}\r\n                    size={'sm'}\r\n                    badgeState={props.userState}\r\n                />\r\n            )}\r\n\r\n            <h3\r\n                style={{\r\n                    marginLeft: '16px',\r\n                    fontSize: '1.3em',\r\n                }}\r\n            >\r\n                Whats Up\r\n            </h3>\r\n        </Header>\r\n    )\r\n}\r\n","import InteractionMessage from './InteractionMessage'\r\n\r\nexport default InteractionMessage\r\n","import * as React from 'react'\r\nimport { ClientMessage } from '../../__shared__/models'\r\nimport { ClientUserStatus } from '../../__shared__/types/userStatus'\r\nimport Avatar, { AvatarProps } from '../Avatar'\r\nimport './InteractionMessage.scss'\r\n\r\nexport interface InteractionMessageProps {\r\n    isSender: boolean\r\n    userStatus: ClientUserStatus | undefined\r\n    message: ClientMessage\r\n    avatarProps?: AvatarProps\r\n    spacePlaceholder?: boolean\r\n    side?: 'left' | 'right'\r\n    showName?: boolean\r\n    squishAbove?: boolean\r\n    squishBelow?: boolean\r\n    styles?: React.CSSProperties\r\n    newestMessageRef?: React.MutableRefObject<HTMLDivElement | null>\r\n    placementClass?: string\r\n    marginTop?: string\r\n}\r\n\r\nexport default function InteractionMessage(props: InteractionMessageProps) {\r\n    const [showTime, setShowTime] = React.useState(false)\r\n\r\n    const personClass = props.isSender\r\n        ? 'interactionmessage-self'\r\n        : 'interactionmessage-friend'\r\n    const placementClass = props.placementClass ? props.placementClass : ''\r\n\r\n    const borderStyling: React.CSSProperties = {}\r\n    if (props.squishAbove) {\r\n        const property = props.isSender\r\n            ? 'borderTopRightRadius'\r\n            : 'borderTopLeftRadius'\r\n        borderStyling[property] = '3px'\r\n    }\r\n    if (props.squishBelow) {\r\n        const property = props.isSender\r\n            ? 'borderBottomRightRadius'\r\n            : 'borderBottomLeftRadius'\r\n        borderStyling[property] = '3px'\r\n    }\r\n\r\n    console.log(props.message.createdAt)\r\n\r\n    return (\r\n        <div\r\n            className={placementClass}\r\n            ref={props.newestMessageRef}\r\n            style={{\r\n                display: 'flex',\r\n                flexDirection: 'column',\r\n                ...(props.marginTop\r\n                    ? { marginTop: props.marginTop }\r\n                    : undefined),\r\n            }}\r\n        >\r\n            {props.showName && !props.isSender && (\r\n                <p\r\n                    style={{\r\n                        marginBottom: '2px',\r\n                        marginTop: '0px',\r\n                        textAlign: props.isSender ? 'right' : 'left',\r\n                        fontSize: '12px',\r\n                        ...(!props.isSender ? { marginLeft: '56px' } : null), // profile pic size + account for border radius\r\n                    }}\r\n                >\r\n                    {props.message.senderName}\r\n                </p>\r\n            )}\r\n\r\n            <div\r\n                style={{\r\n                    display: 'flex',\r\n                    alignSelf:\r\n                        props.side === 'right'\r\n                            ? 'flex-end'\r\n                            : props.side === 'left'\r\n                            ? 'flex-start'\r\n                            : undefined,\r\n                }}\r\n            >\r\n                {!props.isSender && props.avatarProps && (\r\n                    <div\r\n                        style={{\r\n                            marginRight: '8px',\r\n                            height: '36px',\r\n                            width: '36px',\r\n                        }}\r\n                    >\r\n                        <Avatar {...props.avatarProps} />\r\n                    </div>\r\n                )}\r\n                {!props.isSender &&\r\n                    !props.avatarProps &&\r\n                    props.spacePlaceholder && (\r\n                        <div\r\n                            style={{\r\n                                marginRight: '8px',\r\n                                height: '36px',\r\n                                width: '36px',\r\n                            }}\r\n                        ></div>\r\n                    )}\r\n                <p\r\n                    id=\"interactionmessage-text\"\r\n                    className={personClass}\r\n                    style={{ ...borderStyling, whiteSpace: 'pre-wrap' }}\r\n                    onClick={() => setShowTime((prev) => !prev)}\r\n                >\r\n                    {props.message.content}\r\n                </p>\r\n            </div>\r\n            {showTime && (\r\n                <p\r\n                    style={{\r\n                        marginTop: '4px',\r\n                        textAlign: props.side,\r\n                        ...(!props.isSender\r\n                            ? { marginLeft: '56px' }\r\n                            : { marginRight: '12px' }),\r\n                        fontSize: '10px',\r\n                        marginBottom: '0px',\r\n                    }}\r\n                >\r\n                    {new Date(props.message.createdAt).toLocaleString()}\r\n                </p>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n","const MILLIS_IN_SEC = 1000\r\nconst SECS_IN_MIN = 60\r\nconst MINS_IN_HOUR = 60\r\nconst MILLIS_IN_HOUR = MILLIS_IN_SEC * SECS_IN_MIN * MINS_IN_HOUR\r\nconst MILLIS_IN_MIN = MILLIS_IN_SEC * SECS_IN_MIN\r\nconst HOURS_IN_DAY = 24\r\n\r\nexport function convertToMillis({\r\n    days,\r\n    hours,\r\n    mins,\r\n    secs,\r\n    millis,\r\n}: Partial<\r\n    Record<'days' | 'hours' | 'mins' | 'secs' | 'millis', number>\r\n>): number {\r\n    let runningVal = 0\r\n    if (days) {\r\n        runningVal += days * HOURS_IN_DAY * MILLIS_IN_HOUR\r\n    }\r\n    if (hours) {\r\n        runningVal += hours * MILLIS_IN_HOUR\r\n    }\r\n    if (mins) {\r\n        runningVal += mins * MILLIS_IN_MIN\r\n    }\r\n    if (secs) {\r\n        runningVal += secs * MILLIS_IN_SEC\r\n    }\r\n    if (millis) {\r\n        runningVal += millis\r\n    }\r\n    return runningVal\r\n}\r\n\r\nexport function convertToSecs({\r\n    millis,\r\n}: Partial<Record<'millis', number>>): number {\r\n    let runningVal = 0\r\n    if (millis) {\r\n        runningVal += millis / MILLIS_IN_SEC\r\n    }\r\n    return runningVal\r\n}\r\n","import Interaction from './Interaction'\r\n\r\nexport default Interaction\r\n","import * as React from 'react'\r\nimport './Interaction.scss'\r\nimport InteractionMessage from '../InteractionMessage'\r\nimport { ClientConversation, ClientMessage } from '../../__shared__/models'\r\nimport { ClientUserStatuses } from '../../__shared__/types/userStatus'\r\nimport { convertToMillis, convertToSecs } from '../../__shared__/utils/dateTime'\r\nimport { AvatarProps } from '../Avatar'\r\n\r\ninterface MessageStyling {\r\n    squishAbove: {\r\n        [messageId: string]: boolean\r\n    }\r\n    squishBelow: {\r\n        [messageId: string]: boolean\r\n    }\r\n    messagesWithoutAvatar: {\r\n        [messageId: string]: boolean\r\n    }\r\n    marginTop: {\r\n        [messageId: string]: string\r\n    }\r\n}\r\n\r\ninterface Props {\r\n    userId: string\r\n    conversation: ClientConversation\r\n    messages: ClientMessage[]\r\n    statuses: ClientUserStatuses\r\n}\r\n\r\nexport default function Interaction(props: Props) {\r\n    const newestMessageRef = React.useRef<HTMLDivElement | null>(null)\r\n\r\n    React.useEffect(() => {\r\n        if (newestMessageRef.current) {\r\n            newestMessageRef.current.scrollIntoView({ behavior: 'smooth' })\r\n        }\r\n    }, [props.messages.length])\r\n\r\n    /**\r\n     * Calculates which message ids (and in turn, the InteractionMessage) will need\r\n     * to be styled differently with a squished effect.\r\n     */\r\n    function calculateMessageStyling(): MessageStyling {\r\n        const styling: MessageStyling = {\r\n            squishAbove: {},\r\n            squishBelow: {},\r\n            messagesWithoutAvatar: {},\r\n            marginTop: {},\r\n        }\r\n\r\n        return props.messages.reduce(\r\n            (previousStyling, currentMessage, index, arr) => {\r\n                const currentMessageSeconds = convertToSecs({\r\n                    millis: currentMessage.createdAt,\r\n                })\r\n                // Look behind - only when there is a previous message for same user\r\n                if (index > 0) {\r\n                    if (arr[index - 1].sender === currentMessage.sender) {\r\n                        const previousMessageTime = arr[index - 1].createdAt\r\n                        const secondsBetweenLastMessage =\r\n                            currentMessageSeconds -\r\n                            convertToSecs({\r\n                                millis: previousMessageTime,\r\n                            })\r\n                        if (secondsBetweenLastMessage < 60) {\r\n                            previousStyling.squishAbove[\r\n                                currentMessage.id\r\n                            ] = true\r\n                            previousStyling.marginTop[currentMessage.id] = '1px'\r\n                        } else {\r\n                            previousStyling.marginTop[currentMessage.id] =\r\n                                '12px'\r\n                        }\r\n                    } else {\r\n                        previousStyling.marginTop[currentMessage.id] = '30px'\r\n                    }\r\n                }\r\n                // Look ahead - only when a next message exists for same user\r\n                if (\r\n                    arr.length > 0 &&\r\n                    index < arr.length - 1 &&\r\n                    arr[index + 1].sender === currentMessage.sender\r\n                ) {\r\n                    const nextMessageTime = arr[index + 1].createdAt\r\n                    const secondsBetweenNextMessage =\r\n                        convertToSecs({\r\n                            millis: nextMessageTime,\r\n                        }) - currentMessageSeconds\r\n                    if (secondsBetweenNextMessage < 60) {\r\n                        previousStyling.squishBelow[currentMessage.id] = true\r\n                        previousStyling.messagesWithoutAvatar[\r\n                            currentMessage.id\r\n                        ] = true\r\n                    }\r\n                }\r\n                return previousStyling\r\n            },\r\n            styling\r\n        )\r\n    }\r\n\r\n    function renderMessagesTimeline() {\r\n        const styling = calculateMessageStyling()\r\n        const now = new Date() // race condition possible, but chances are small\r\n        const dayFormatter = new Intl.DateTimeFormat('en-US', {\r\n            weekday: 'long',\r\n        })\r\n        const monthFormatter = new Intl.DateTimeFormat('en-US', {\r\n            month: 'short',\r\n        })\r\n        return props.messages.map((message, index, arr) => {\r\n            const isSender = !!(props.userId && props.userId === message.sender)\r\n            const userStatus = props.statuses[message.sender]\r\n            const currentDate = new Date(message.createdAt)\r\n            let showTimelineAboveMessage: boolean = false\r\n\r\n            // show timeline if current message is first in the list,\r\n            // or if the previous message is a different day tha the current message\r\n            // or if the previous message is 3 or more hours since the current message\r\n\r\n            if (index === 0) {\r\n                showTimelineAboveMessage = true\r\n            } else {\r\n                const pastDate = new Date(arr[index - 1].createdAt)\r\n                showTimelineAboveMessage =\r\n                    index === 0 ||\r\n                    pastDate.toDateString() !== currentDate.toDateString() ||\r\n                    pastDate.getTime() >=\r\n                        currentDate.getTime() + convertToMillis({ hours: 3 })\r\n            }\r\n\r\n            let hours: number | string = currentDate.getHours()\r\n            let minutes: number | string = currentDate.getMinutes()\r\n            hours = hours < 10 ? `${0}${hours}` : hours\r\n            minutes = minutes < 10 ? `${0}${minutes}` : minutes\r\n\r\n            let timelineTime = `${hours}:${minutes}`\r\n            let timelineDay\r\n            if (showTimelineAboveMessage) {\r\n                if (currentDate.toDateString() === now.toDateString()) {\r\n                    timelineDay = 'Today'\r\n                } else if (\r\n                    currentDate.toDateString() ===\r\n                    new Date(\r\n                        now.getTime() - convertToMillis({ days: 1 })\r\n                    ).toDateString()\r\n                ) {\r\n                    timelineDay = 'Yesterday'\r\n                } else {\r\n                    // When calculating messages, we want to see if a message is\r\n                    // within 6 days inclusive.\r\n                    const nowOffset = convertToMillis({\r\n                        hours: now.getHours(),\r\n                        mins: now.getMinutes(),\r\n                        secs: now.getSeconds(),\r\n                        millis: now.getMilliseconds(),\r\n                    })\r\n                    // Within last 6 running days inclusive.\r\n                    // one day has 1000*60*60*24 milliseconds)\r\n                    if (\r\n                        currentDate.getTime() >\r\n                        new Date(\r\n                            now.getTime() -\r\n                                (convertToMillis({ days: 6 }) + nowOffset)\r\n                        ).getTime()\r\n                    ) {\r\n                        timelineDay = dayFormatter.format(currentDate)\r\n                    } else {\r\n                        const month = monthFormatter.format(currentDate)\r\n                        timelineDay = `${dayFormatter.format(\r\n                            currentDate\r\n                        )}, ${month} ${currentDate.getDate()}`\r\n                    }\r\n                }\r\n            }\r\n\r\n            const avatarAvailable: boolean =\r\n                !!message.photoURL && !styling.messagesWithoutAvatar[message.id]\r\n\r\n            return (\r\n                <React.Fragment key={`rf-${message.id}`}>\r\n                    {showTimelineAboveMessage && timelineDay && (\r\n                        <p\r\n                            key={`tmln-${message.id}`}\r\n                            style={{\r\n                                textAlign: 'center',\r\n                                marginTop: '30px',\r\n                                marginBottom: '8px',\r\n                            }}\r\n                        >\r\n                            {`${timelineDay} - ${timelineTime}`}\r\n                        </p>\r\n                    )}\r\n                    <InteractionMessage\r\n                        key={message.id}\r\n                        message={message}\r\n                        newestMessageRef={\r\n                            index === props.messages.length - 1\r\n                                ? newestMessageRef\r\n                                : undefined\r\n                        }\r\n                        isSender={isSender}\r\n                        side={isSender ? 'right' : 'left'}\r\n                        userStatus={userStatus}\r\n                        spacePlaceholder={!isSender && !avatarAvailable}\r\n                        avatarProps={\r\n                            !isSender && avatarAvailable\r\n                                ? ({\r\n                                      photoURL: message.photoURL,\r\n                                      badgeState: userStatus.state,\r\n                                  } as AvatarProps)\r\n                                : undefined\r\n                        }\r\n                        squishAbove={styling.squishAbove[message.id]}\r\n                        squishBelow={styling.squishBelow[message.id]}\r\n                        showName={!styling.squishAbove[message.id]}\r\n                        placementClass={\r\n                            props.userId && props.userId === message.sender\r\n                                ? 'interactionmessage-placement-self'\r\n                                : 'interactionmessage-placement-friend'\r\n                        }\r\n                        marginTop={styling.marginTop[message.id]}\r\n                    />\r\n                </React.Fragment>\r\n            )\r\n        })\r\n    }\r\n\r\n    return <div id=\"interaction-root\">{renderMessagesTimeline()}</div>\r\n}\r\n\r\nexport type { Props as InteractionProps }\r\n","import InteractionMessageEditor from './InteractionMessageEditor'\r\n\r\nexport default InteractionMessageEditor\r\n","import * as React from 'react'\r\nimport './InteractionMessageEditor.scss'\r\n\r\ninterface Props {\r\n    currentDraft: string\r\n    handleSend(e: React.MouseEvent<HTMLInputElement, MouseEvent>): void\r\n    handleMessageChange(e: React.ChangeEvent<HTMLTextAreaElement>): void\r\n}\r\n\r\nexport default function InteractionMessageEditor(props: Props) {\r\n    return (\r\n        <div id=\"interactionmessageeditor-root\">\r\n            <textarea\r\n                onChange={props.handleMessageChange}\r\n                value={props.currentDraft}\r\n            />\r\n            <input type=\"button\" value=\"Send\" onClick={props.handleSend} />\r\n        </div>\r\n    )\r\n}\r\n","import React from 'react'\r\n\r\nexport function ChatsLayout(props: { children: React.ReactNode }) {\r\n    return (\r\n        <div\r\n            style={{\r\n                display: 'flex',\r\n                flexDirection: 'column',\r\n                flexGrow: 2,\r\n                flexBasis: 0,\r\n                maxWidth: '700px',\r\n            }}\r\n        >\r\n            {props.children}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport function InteractionLayout(props: { children: React.ReactNode }) {\r\n    return (\r\n        <div\r\n            style={{\r\n                display: 'flex',\r\n                flexDirection: 'column',\r\n                backgroundColor: 'grey',\r\n                flexGrow: 3,\r\n                flexBasis: 0,\r\n            }}\r\n        >\r\n            {props.children}\r\n        </div>\r\n    )\r\n}\r\n","import * as React from 'react'\r\nimport Header from '../Header'\r\n\r\ninterface Props {\r\n    showSignInPopup: (method: 'google' | 'github') => void\r\n}\r\n\r\nexport function SignIn(props: Props) {\r\n    return (\r\n        <div style={{ height: '100%' }}>\r\n            <Header>\r\n                <h3\r\n                    style={{\r\n                        marginLeft: '16px',\r\n                        fontSize: '1.3em',\r\n                    }}\r\n                >\r\n                    Whats Up\r\n                </h3>\r\n            </Header>\r\n            <div\r\n                style={{\r\n                    height: '100%',\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    justifyContent: 'center',\r\n                    flexDirection: 'column',\r\n                }}\r\n            >\r\n                <button\r\n                    style={{\r\n                        margin: '4px',\r\n                        fontSize: '24px',\r\n                        marginBottom: '16px',\r\n                    }}\r\n                    onClick={() => props.showSignInPopup('google')}\r\n                >\r\n                    Sign in with Google\r\n                </button>\r\n                <button\r\n                    style={{ margin: '4px', fontSize: '24px' }}\r\n                    onClick={() => props.showSignInPopup('github')}\r\n                >\r\n                    Sign in with Github\r\n                </button>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","import firebase from 'firebase'\r\nimport { useEffect, useState } from 'react'\r\nimport useLocalStorageState from '../utils/useLocalStorageState'\r\n\r\nexport type SupportedAuthProvider = 'google' | 'github'\r\n\r\nconst config = {\r\n    apiKey: 'AIzaSyA51jM6IryfHm1HnzmXo66QQQCcRK1ld0M',\r\n    authDomain: 'whats-up-ce34e.firebaseapp.com',\r\n    projectId: 'whats-up-ce34e',\r\n    storageBucket: 'whats-up-ce34e.appspot.com',\r\n    messagingSenderId: '6258283268',\r\n    appId: '1:6258283268:web:91c3f62da6da184d583651',\r\n    measurementId: 'G-K13ZDZ04JX',\r\n}\r\n\r\nexport default function useFirebaseAuth(): [\r\n    firebase.User | null,\r\n    (method: SupportedAuthProvider) => void\r\n] {\r\n    const [user, setUser] = useLocalStorageState<firebase.User>('firebaseUser')\r\n    const [\r\n        githubProvider,\r\n        setGithubProvider,\r\n    ] = useState<firebase.auth.GithubAuthProvider | null>(null)\r\n    const [\r\n        googleProvider,\r\n        setGoogleProvider,\r\n    ] = useState<firebase.auth.GoogleAuthProvider | null>(null)\r\n\r\n    function showSignInPopup(method: SupportedAuthProvider) {\r\n        let selectedProvider\r\n        if (method === 'github' && githubProvider) {\r\n            selectedProvider = githubProvider\r\n        } else if (method === 'google' && googleProvider) {\r\n            selectedProvider = googleProvider\r\n        } else {\r\n            return\r\n        }\r\n\r\n        firebase\r\n            .auth()\r\n            .signInWithPopup(selectedProvider)\r\n            .catch((error) => {\r\n                console.error(`Unable to log in with error ${error}`)\r\n            })\r\n    }\r\n\r\n    async function createUserInFirebaseIfNonexistent(user: firebase.User) {\r\n        const snapshot = await firebase\r\n            .database()\r\n            .ref(`users/${user.uid}`)\r\n            .once('value')\r\n        if (snapshot.val()) {\r\n            await firebase.database().ref(`users/${user.uid}`).update({\r\n                userName: user.displayName,\r\n                photoURL: user.photoURL,\r\n            })\r\n        } else {\r\n            console.log(`User ${user.uid} does not exist. Creating now.`)\r\n            await firebase.database().ref(`users/${user.uid}`).set({\r\n                userName: user.displayName,\r\n                photoURL: user.photoURL,\r\n            })\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (firebase.apps.length === 0) {\r\n            firebase.initializeApp(config)\r\n        }\r\n        const githubProvider = new firebase.auth.GithubAuthProvider()\r\n        const googleProvider = new firebase.auth.GoogleAuthProvider()\r\n        setGithubProvider(githubProvider)\r\n        setGoogleProvider(googleProvider)\r\n        firebase.auth().onAuthStateChanged((user) => {\r\n            if (user) {\r\n                // log in\r\n                setUser(user)\r\n                createUserInFirebaseIfNonexistent(user)\r\n            } else {\r\n                // log out\r\n                setUser(null)\r\n            }\r\n        })\r\n        // Don't need to worry about setUser since it's the setter from useState\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [])\r\n\r\n    return [user, showSignInPopup]\r\n}\r\n","import { SetStateAction } from 'react'\r\nimport { Dispatch, useEffect, useState } from 'react'\r\n\r\nexport default function useLocalStorageState<T = null>(\r\n    key: string\r\n): [T | null, Dispatch<SetStateAction<T | null>>] {\r\n    const [value, setValue] = useState<T | null>(() => {\r\n        const storedValue = localStorage.getItem(key)\r\n        const parsed = !!storedValue && JSON.parse(storedValue)\r\n        if (!parsed) {\r\n            return null\r\n        } else {\r\n            return parsed\r\n        }\r\n    })\r\n\r\n    useEffect(() => {\r\n        localStorage.setItem(key, JSON.stringify(value))\r\n    }, [key, value])\r\n\r\n    return [value, setValue]\r\n}\r\n","import InteractionCreator from \"./InteractionCreator\";\r\n\r\nexport default InteractionCreator","import * as React from 'react'\r\nimport { ClientUser } from '../../__shared__/types/user'\r\nimport { ClientUserStatuses } from '../../__shared__/types/userStatus'\r\nimport {\r\n    ConversationFormAction,\r\n    ConversationFormState,\r\n} from '../App/useConversationFormReducer'\r\nimport Avatar from '../Avatar'\r\nimport './InteractionCreator.scss'\r\n\r\ninterface Props {\r\n    userId: string | undefined\r\n    users: ClientUser[]\r\n    userStatuses: ClientUserStatuses\r\n    formState: ConversationFormState\r\n    dispatchForm: React.Dispatch<ConversationFormAction>\r\n}\r\n\r\nexport default function InteractionCreator(props: Props) {\r\n    function handlePersonSelect(e: React.ChangeEvent<HTMLInputElement>) {\r\n        e.preventDefault()\r\n        props.dispatchForm({\r\n            type: 'toggle_person',\r\n            payload: e.target.dataset.personid as string,\r\n        })\r\n    }\r\n\r\n    return (\r\n        <div id=\"InteractionCreator-root\">\r\n            <h4 style={{ marginTop: '0' }}>\r\n                Choose a conversation name (optional)\r\n            </h4>\r\n            <input\r\n                id=\"conversation-name-input\"\r\n                type=\"text\"\r\n                value={props.formState.newConversationName}\r\n                onChange={(e) =>\r\n                    props.dispatchForm({\r\n                        type: 'set_conversation_name',\r\n                        payload: e.currentTarget.value,\r\n                    })\r\n                }\r\n            ></input>\r\n\r\n            <h4>Select people to add *</h4>\r\n            <div>\r\n                {props.users\r\n                    .filter((user) => user.id !== props.userId)\r\n                    .map((user) => {\r\n                        return (\r\n                            <div\r\n                                key={`pselect-${user.id}`}\r\n                                className={'hover'}\r\n                                style={{\r\n                                    display: 'flex',\r\n                                    justifyContent: 'left',\r\n                                    alignItems: 'center',\r\n                                    minWidth: '20px',\r\n                                    userSelect: 'none',\r\n                                    padding: '8px 16px',\r\n                                    border: '1px solid #737373',\r\n                                    borderRadius: '3px',\r\n                                    marginTop: '8px',\r\n                                    backgroundColor: props.formState.peopleForNewConversation.includes(\r\n                                        user.id\r\n                                    )\r\n                                        ? '#696969'\r\n                                        : undefined,\r\n                                }}\r\n                                data-personid={user.id}\r\n                                // @ts-ignore\r\n                                onClick={handlePersonSelect}\r\n                            >\r\n                                {user.photoURL && (\r\n                                    <Avatar\r\n                                        photoURL={user.photoURL}\r\n                                        badgeState={\r\n                                            props.userStatuses[user.id].state\r\n                                        }\r\n                                        style={{\r\n                                            marginRight: '8px',\r\n                                        }}\r\n                                    />\r\n                                )}\r\n                                {user.userName}\r\n                            </div>\r\n                        )\r\n                    })}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport type { Props as InteractionCreatorProps }\r\n","import InteractionBar from './InteractionBar'\r\n\r\nexport default InteractionBar\r\n","import * as React from 'react'\r\nimport { ClientConversation } from '../../__shared__/models'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport { faArrowLeft } from '@fortawesome/free-solid-svg-icons'\r\nimport Header from '../Header'\r\n\r\ninterface Props {\r\n    back: () => void\r\n    backIcon: string\r\n    conversation: ClientConversation\r\n}\r\n\r\nexport default function InteractionBar(props: Props) {\r\n    return (\r\n        <Header>\r\n            <div\r\n                onClick={props.back}\r\n                style={{\r\n                    display: 'flex',\r\n                    backgroundColor: 'black',\r\n                    color: 'white',\r\n                    borderRadius: '5px',\r\n                    cursor: 'pointer',\r\n                    padding: '8px 8px 8px 0',\r\n                }}\r\n            >\r\n                <FontAwesomeIcon icon={faArrowLeft} size={'lg'} />\r\n            </div>\r\n            <h3 style={{ marginLeft: '8px' }}>{props.conversation.name}</h3>\r\n        </Header>\r\n    )\r\n}\r\n","import * as React from 'react'\r\nimport firebase from 'firebase'\r\n\r\ninterface Props {\r\n    displayName: string\r\n    updateProfile: (\r\n        userInfo: Partial<Pick<firebase.UserInfo, 'displayName' | 'photoURL'>>\r\n    ) => void\r\n}\r\n\r\nexport function UserSettings(props: Props) {\r\n    const [newUsername, setNewUsername] = React.useState(props.displayName)\r\n\r\n    function handleSubmit(e: React.FormEvent<HTMLFormElement>) {\r\n        e.preventDefault()\r\n        if (newUsername) {\r\n            props.updateProfile({\r\n                displayName: newUsername,\r\n            })\r\n        } else {\r\n            console.error('Username was not valid.')\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div\r\n            style={{\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n            }}\r\n        >\r\n            <form\r\n                style={{\r\n                    display: 'flex',\r\n                    flexDirection: 'column',\r\n                    padding: '8px',\r\n                }}\r\n                onSubmit={handleSubmit}\r\n            >\r\n                <div\r\n                    style={{\r\n                        display: 'flex',\r\n                        padding: '4px',\r\n                        marginBottom: '16px',\r\n                        flexDirection: 'column',\r\n                    }}\r\n                >\r\n                    <label\r\n                        htmlFor=\"username-input\"\r\n                        style={{ paddingBottom: '4px' }}\r\n                    >\r\n                        Username\r\n                    </label>\r\n                    <input\r\n                        id=\"username-input\"\r\n                        type=\"text\"\r\n                        placeholder=\"Type in the user name\"\r\n                        value={newUsername}\r\n                        onChange={(e) => setNewUsername(e.target.value)}\r\n                    ></input>\r\n                </div>\r\n                <input type=\"submit\" value=\"Save\"></input>\r\n            </form>\r\n        </div>\r\n    )\r\n}\r\n","import React, { useReducer, Reducer } from 'react'\r\n\r\nexport type LayoutStateActionType =\r\n    | 'show_conversation_form'\r\n    | 'show_user_settings'\r\n    | 'select_conversation'\r\n    | 'return_to_main'\r\n\r\ninterface Action {\r\n    type: LayoutStateActionType\r\n}\r\n\r\ninterface State {\r\n    showConversationForm: boolean\r\n    showUserSettings: boolean\r\n}\r\n\r\nfunction layoutStateReducer(state: State, action: Action): State {\r\n    switch (action.type) {\r\n        case 'return_to_main':\r\n            return {\r\n                ...state,\r\n                showConversationForm: false,\r\n                showUserSettings: false,\r\n            }\r\n        case 'select_conversation':\r\n            return {\r\n                ...state,\r\n                showConversationForm: false,\r\n                showUserSettings: false,\r\n            }\r\n        case 'show_conversation_form':\r\n            return {\r\n                ...state,\r\n                showConversationForm: true,\r\n                showUserSettings: false,\r\n            }\r\n        case 'show_user_settings':\r\n            return {\r\n                ...state,\r\n                showConversationForm: false,\r\n                showUserSettings: true,\r\n            }\r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\nexport function useLayoutStateReducer(): [State, React.Dispatch<Action>] {\r\n    const [state, dispatch] = useReducer<Reducer<State, Action>>(\r\n        layoutStateReducer,\r\n        {\r\n            showConversationForm: false,\r\n            showUserSettings: false,\r\n        }\r\n    )\r\n\r\n    return [state, dispatch]\r\n}\r\n","import React from 'react'\r\nimport styles from './BottomSettings.module.scss'\r\n\r\ninterface Props {\r\n    logOut: () => void\r\n    openUserSettings: (\r\n        e: React.MouseEvent<HTMLButtonElement, MouseEvent>\r\n    ) => void\r\n}\r\n\r\nfunction BottomSettings(props: Props) {\r\n    return (\r\n        <div className={styles.root}>\r\n            {/* <button\r\n                onClick={props.openUserSettings}\r\n                style={{ marginBottom: '8px' }}\r\n            >\r\n                Edit User Settings\r\n            </button> */}\r\n            <button onClick={props.logOut}>Log Out</button>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default BottomSettings\r\n","import React, { useReducer, Reducer } from 'react'\r\n\r\ntype ActionType = 'set_conversation_name' | 'toggle_person'\r\n\r\ninterface Action {\r\n    type: ActionType\r\n    payload: string\r\n}\r\n\r\ninterface State {\r\n    newConversationName: string\r\n    peopleForNewConversation: string[]\r\n}\r\n\r\nfunction conversationFormReducer(state: State, action: Action): State {\r\n    switch (action.type) {\r\n        case 'set_conversation_name':\r\n            return {\r\n                ...state,\r\n                newConversationName: action.payload,\r\n            }\r\n        case 'toggle_person':\r\n            if (state.peopleForNewConversation.includes(action.payload)) {\r\n                return {\r\n                    ...state,\r\n                    peopleForNewConversation: state.peopleForNewConversation.filter(\r\n                        (person) => person !== action.payload\r\n                    ),\r\n                }\r\n            } else {\r\n                return {\r\n                    ...state,\r\n                    peopleForNewConversation: [\r\n                        ...state.peopleForNewConversation,\r\n                        action.payload,\r\n                    ],\r\n                }\r\n            }\r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\nexport function useConversationFormReducer(): [State, React.Dispatch<Action>] {\r\n    const [state, dispatch] = useReducer<Reducer<State, Action>>(\r\n        conversationFormReducer,\r\n        {\r\n            newConversationName: '',\r\n            peopleForNewConversation: [],\r\n        }\r\n    )\r\n\r\n    return [state, dispatch]\r\n}\r\n\r\nexport type { State as ConversationFormState }\r\nexport type { Action as ConversationFormAction }\r\n","import React from 'react'\r\nimport './styles.scss'\r\nimport '../../__shared__/styles.scss'\r\nimport ChatPreview from '../ChatPreview'\r\nimport HomeToolbar from '../HomeHeader'\r\nimport Interaction from '../Interaction'\r\nimport InteractionMessageEditor from '../InteractionMessageEditor'\r\nimport { ChatsLayout as HomeLayout, InteractionLayout } from './layouts'\r\nimport withAuth from '../../__shared__/auth/withAuth'\r\nimport firebase from 'firebase'\r\nimport InteractionCreator from '../InteractionCreator'\r\nimport { useConversation } from '../../__shared__/hooks/useConversation'\r\nimport { useWindowSize } from '../../__shared__/hooks/useWindowSize'\r\nimport InteractionBar from '../InteractionBar'\r\nimport { UserSettings } from '../UserSettings'\r\nimport { ClientConversation } from '../../__shared__/models'\r\nimport {\r\n    LayoutStateActionType,\r\n    useLayoutStateReducer,\r\n} from './useLayoutStateReducer'\r\nimport { useUsers } from './useUsers'\r\nimport BottomSettings from '../BottomSettings'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport { faPlusCircle } from '@fortawesome/free-solid-svg-icons'\r\nimport { faArrowLeft } from '@fortawesome/free-solid-svg-icons'\r\nimport Header from '../Header'\r\nimport { useConversationFormReducer } from './useConversationFormReducer'\r\n\r\ntype ConversationIdDispatchValue<\r\n    T extends LayoutStateActionType\r\n> = T extends 'select_conversation'\r\n    ? {\r\n          conversationId: string\r\n      }\r\n    : {\r\n          conversationId?: never\r\n      }\r\n\r\ntype DispatchWithConversationAction<T extends LayoutStateActionType> = {\r\n    type: T\r\n} & ConversationIdDispatchValue<T>\r\n\r\ninterface AppProps {\r\n    user: firebase.User | null\r\n}\r\n\r\nfunction App(props: AppProps) {\r\n    const appInitiated = firebase.apps.length > 0\r\n\r\n    const {\r\n        messages,\r\n        conversations,\r\n        conversationId,\r\n        setConversationId,\r\n    } = useConversation(appInitiated, props.user?.uid)\r\n    const currentConversation = conversationId\r\n        ? (conversations.find(\r\n              (c) => c.id === conversationId\r\n          ) as ClientConversation)\r\n        : null\r\n\r\n    const [users, userStatuses] = useUsers(appInitiated, props.user?.uid)\r\n\r\n    const windowSize = useWindowSize()\r\n\r\n    const [currentDraft, setCurrentDraft] = React.useState('')\r\n\r\n    const [layoutState, layoutStateDispatch] = useLayoutStateReducer()\r\n\r\n    const [\r\n        conversationFormState,\r\n        dispatchConversationForm,\r\n    ] = useConversationFormReducer()\r\n\r\n    function handlePreviewSelect(id: string) {\r\n        dispatchWithConversationId({\r\n            type: 'select_conversation',\r\n            conversationId: id,\r\n        })\r\n    }\r\n\r\n    function dispatchWithConversationId<T extends LayoutStateActionType>(\r\n        action: DispatchWithConversationAction<T>\r\n    ) {\r\n        layoutStateDispatch({ type: action.type })\r\n        setConversationId(action.conversationId || null)\r\n    }\r\n\r\n    function handleMessageChange(e: React.ChangeEvent<HTMLTextAreaElement>) {\r\n        e.preventDefault()\r\n        setCurrentDraft(e.target.value)\r\n    }\r\n\r\n    async function createConversation() {\r\n        if (!props.user) {\r\n            console.error('not logged in')\r\n            return\r\n        } else if (\r\n            conversationFormState.peopleForNewConversation.length === 0\r\n        ) {\r\n            console.error('no friends to add')\r\n            return\r\n        }\r\n\r\n        try {\r\n            const db = firebase.database()\r\n\r\n            // Check if friendIds are valid\r\n            const friendSnapshots = await Promise.all(\r\n                conversationFormState.peopleForNewConversation.map(\r\n                    (personId) => {\r\n                        return db.ref(`users/${personId}`).once('value')\r\n                    }\r\n                )\r\n            )\r\n\r\n            for (let snapshot of friendSnapshots) {\r\n                if (!snapshot.val()) {\r\n                    alert(`Friend ID ${snapshot.key} does not exist.`)\r\n                    return\r\n                }\r\n            }\r\n\r\n            // Create new conversation\r\n            const conversationRef = await db.ref(`conversations`).push()\r\n            const conversationId = conversationRef.key\r\n\r\n            await conversationRef.set({\r\n                createdAt: firebase.database.ServerValue.TIMESTAMP,\r\n                creatorId: props.user.uid,\r\n                name: conversationFormState.newConversationName,\r\n            })\r\n\r\n            const everythingElse: Record<string, any> = {}\r\n\r\n            // For self\r\n            everythingElse[\r\n                `userConversations/${props.user.uid}/${conversationId}`\r\n            ] = {\r\n                invitedBy: props.user.uid,\r\n            }\r\n            everythingElse[\r\n                `conversationUsers/${conversationId}/${props.user.uid}`\r\n            ] = {\r\n                invitedBy: props.user.uid,\r\n                userName: props.user.displayName,\r\n            }\r\n\r\n            // For friends\r\n            friendSnapshots.forEach((snapshot) => {\r\n                everythingElse[\r\n                    `userConversations/${snapshot.key}/${conversationId}`\r\n                ] = {\r\n                    invitedBy: props.user?.uid,\r\n                }\r\n                everythingElse[\r\n                    `conversationUsers/${conversationId}/${snapshot.key}`\r\n                ] = {\r\n                    invitedBy: props.user?.uid,\r\n                    userName: snapshot.child('userName').val() || '',\r\n                }\r\n            })\r\n\r\n            await db.ref().update(everythingElse)\r\n\r\n            if (conversationId) {\r\n                dispatchWithConversationId({\r\n                    type: 'select_conversation',\r\n                    conversationId,\r\n                })\r\n            }\r\n        } catch (outerError) {\r\n            alert(`something went wrong: ${outerError}`)\r\n        }\r\n    }\r\n\r\n    async function createMessage(\r\n        e: React.MouseEvent<HTMLInputElement, MouseEvent>\r\n    ) {\r\n        e.preventDefault()\r\n\r\n        if (!props.user || !appInitiated) {\r\n            console.error('not logged in')\r\n            return\r\n        }\r\n\r\n        const message = {\r\n            sender: props.user.uid,\r\n            senderName: props.user.displayName || '',\r\n            createdAt: firebase.database.ServerValue.TIMESTAMP,\r\n            content: currentDraft,\r\n            photoURL: props.user.photoURL,\r\n        }\r\n\r\n        const newMessageRef = await firebase\r\n            .database()\r\n            .ref(`messages/${conversationId}`)\r\n            .push()\r\n        newMessageRef.set(message, (error) => {\r\n            if (error) {\r\n                alert(`something went wrong... ${error}`)\r\n            } else {\r\n                setCurrentDraft('')\r\n            }\r\n        })\r\n    }\r\n\r\n    function logOut() {\r\n        firebase\r\n            .auth()\r\n            .signOut()\r\n            .catch((e) => {\r\n                window.alert(`Unable to sign out with error ${e}`)\r\n            })\r\n    }\r\n\r\n    function openConversationForm(\r\n        e: React.MouseEvent<HTMLInputElement, MouseEvent>\r\n    ) {\r\n        e.preventDefault()\r\n        dispatchWithConversationId({ type: 'show_conversation_form' })\r\n    }\r\n\r\n    function openUserSettings(\r\n        e: React.MouseEvent<HTMLButtonElement, MouseEvent>\r\n    ) {\r\n        e.preventDefault()\r\n        dispatchWithConversationId({ type: 'show_user_settings' })\r\n    }\r\n\r\n    function updateUserProfile(\r\n        userInfo: Partial<Pick<firebase.UserInfo, 'displayName' | 'photoURL'>>\r\n    ) {\r\n        props.user?.updateProfile(userInfo).catch((error) => {\r\n            alert(`user profile not updated with error ${error}`)\r\n        })\r\n    }\r\n\r\n    function returnToMain() {\r\n        dispatchWithConversationId({ type: 'return_to_main' })\r\n    }\r\n\r\n    const showInteractionLayout =\r\n        windowSize !== 'xs' ||\r\n        (windowSize === 'xs' &&\r\n            (conversationId ||\r\n                layoutState.showConversationForm ||\r\n                layoutState.showUserSettings))\r\n    const showHomeLayout =\r\n        windowSize !== 'xs' ||\r\n        (windowSize === 'xs' &&\r\n            !conversationId &&\r\n            !layoutState.showConversationForm &&\r\n            !layoutState.showUserSettings)\r\n\r\n    return (\r\n        <div id=\"app-root\">\r\n            {showHomeLayout && (\r\n                <HomeLayout>\r\n                    <HomeToolbar\r\n                        user={props.user}\r\n                        userState={\r\n                            props.user && userStatuses[props.user.uid]?.state\r\n                        }\r\n                    />\r\n                    <div\r\n                        onClick={openConversationForm}\r\n                        className=\"hover\"\r\n                        style={{\r\n                            margin: '16px 0',\r\n                            padding: '8px 16px',\r\n                            display: 'flex',\r\n                            alignItems: 'center',\r\n                            justifyContent: 'center',\r\n                        }}\r\n                    >\r\n                        New conversation\r\n                        <div\r\n                            style={{\r\n                                display: 'flex',\r\n                                height: '32px',\r\n                                width: '32px',\r\n                                backgroundColor: 'black',\r\n                                alignItems: 'center',\r\n                                justifyContent: 'center',\r\n                                color: 'white',\r\n                                borderRadius: '5px',\r\n                                marginLeft: '8px',\r\n                            }}\r\n                        >\r\n                            <FontAwesomeIcon icon={faPlusCircle} size={'sm'} />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div\r\n                        style={{\r\n                            height: '100%',\r\n                            padding: '0px 0px 16px',\r\n                        }}\r\n                    >\r\n                        <div>\r\n                            <div\r\n                                style={{\r\n                                    overflow: 'auto',\r\n                                }}\r\n                            >\r\n                                {conversations.map((convo) => (\r\n                                    <ChatPreview\r\n                                        key={convo.id}\r\n                                        conversation={convo}\r\n                                        onPreviewClick={handlePreviewSelect}\r\n                                    />\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <BottomSettings\r\n                        logOut={logOut}\r\n                        openUserSettings={openUserSettings}\r\n                    />\r\n                </HomeLayout>\r\n            )}\r\n\r\n            {showInteractionLayout && (\r\n                <InteractionLayout>\r\n                    {currentConversation && props.user ? (\r\n                        <>\r\n                            <InteractionBar\r\n                                backIcon={windowSize === 'xs' ? '<' : 'X'}\r\n                                back={returnToMain}\r\n                                conversation={currentConversation}\r\n                            />\r\n                            <Interaction\r\n                                userId={props.user.uid}\r\n                                conversation={currentConversation}\r\n                                messages={messages}\r\n                                statuses={userStatuses}\r\n                            />\r\n                            <InteractionMessageEditor\r\n                                // userId={props.user.uid}\r\n                                currentDraft={currentDraft}\r\n                                handleMessageChange={handleMessageChange}\r\n                                handleSend={createMessage}\r\n                            />\r\n                        </>\r\n                    ) : layoutState.showConversationForm ? (\r\n                        <>\r\n                            <Header>\r\n                                <div\r\n                                    onClick={returnToMain}\r\n                                    style={{\r\n                                        display: 'flex',\r\n                                        backgroundColor: 'black',\r\n                                        color: 'white',\r\n                                        borderRadius: '5px',\r\n                                        cursor: 'pointer',\r\n                                        padding: '8px 8px 8px 0',\r\n                                    }}\r\n                                >\r\n                                    <FontAwesomeIcon\r\n                                        icon={faArrowLeft}\r\n                                        size={'lg'}\r\n                                    />\r\n                                </div>\r\n                                <h3 style={{ marginLeft: '8px' }}>\r\n                                    New conversation\r\n                                </h3>\r\n                                <div\r\n                                    onClick={createConversation}\r\n                                    style={{\r\n                                        cursor: 'pointer',\r\n                                        padding: '8px 0 8px 8px',\r\n                                        marginLeft: 'auto',\r\n                                    }}\r\n                                >\r\n                                    Create\r\n                                </div>\r\n                            </Header>\r\n                            <InteractionCreator\r\n                                userId={props.user?.uid}\r\n                                users={users}\r\n                                userStatuses={userStatuses}\r\n                                formState={conversationFormState}\r\n                                dispatchForm={dispatchConversationForm}\r\n                            />\r\n                        </>\r\n                    ) : layoutState.showUserSettings ? (\r\n                        <UserSettings\r\n                            displayName={props.user?.displayName || ''}\r\n                            updateProfile={updateUserProfile}\r\n                        />\r\n                    ) : null}\r\n                </InteractionLayout>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default withAuth(App)\r\n","import * as React from 'react'\r\nimport { SignIn } from '../../components/SignIn'\r\nimport useFirebaseAuth from './useFirebaseAuth'\r\n\r\nexport default function withAuth(WrappedComponent: React.ElementType) {\r\n    return function Hoc(props: Record<string, unknown>) {\r\n        const [user, showSignInPopup] = useFirebaseAuth()\r\n\r\n        return user ? (\r\n            <WrappedComponent user={user} {...props} />\r\n        ) : (\r\n            <SignIn showSignInPopup={showSignInPopup} />\r\n        )\r\n    }\r\n}\r\n","import App from './App'\r\n\r\nexport default App\r\n","import React, { useState, useEffect } from 'react'\r\nimport firebase from 'firebase'\r\nimport { ClientConversation, ClientMessage, ServerMessage } from '../models'\r\n\r\n/**\r\n * The primary hook of the app. Fetches and listens to conversation and message data\r\n */\r\nexport function useConversation(\r\n    initialized: boolean,\r\n    userId?: string\r\n): {\r\n    messages: ClientMessage[]\r\n    conversations: ClientConversation[]\r\n    conversationId: string | null\r\n    setConversationId: React.Dispatch<React.SetStateAction<string | null>>\r\n} {\r\n    const [conversations, setConversations] = useState<ClientConversation[]>([])\r\n    const [conversationId, setConversationId] = useState<string | null>(null)\r\n    const [messages, setMessages] = useState<ClientMessage[]>([])\r\n\r\n    /**\r\n     * Pull conversations, userConversations, and conversationUsers.\r\n     * Also listens to new conversations.\r\n     */\r\n    useEffect(() => {\r\n        try {\r\n            if (!initialized || !userId) {\r\n                return\r\n            }\r\n\r\n            const db = firebase.database()\r\n\r\n            const userConversationsRefString = `userConversations/${userId}`\r\n            const userConversationsRef = db.ref(userConversationsRefString)\r\n\r\n            // What I need to do next is display a list of conversations in the UI that the user has access to.\r\n            // I need to use a combination of userConversations and conversations.\r\n            // userConversations for knowing which user has access to what conversation,\r\n            // and conversations for getting the metadata of conversations,\r\n            // then conversationUsers to know who is in the conversation.\r\n\r\n            ;(async () => {\r\n                const userConversationsOnce = await userConversationsRef\r\n                    .orderByKey()\r\n                    .once('value')\r\n                const initialConversations: ClientConversation[] = []\r\n                let lastInitialUserConversationId = ''\r\n                if (userConversationsOnce.exists()) {\r\n                    const convoPromises: Promise<firebase.database.DataSnapshot>[] = []\r\n                    const cuPromises: Promise<firebase.database.DataSnapshot>[] = []\r\n\r\n                    userConversationsOnce.forEach((uc) => {\r\n                        convoPromises.push(\r\n                            db\r\n                                .ref(`conversations/${uc.key}`)\r\n                                .orderByKey()\r\n                                .once('value')\r\n                        )\r\n                        cuPromises.push(\r\n                            db\r\n                                .ref(`conversationUsers/${uc.key}`)\r\n                                .orderByKey()\r\n                                .once('value')\r\n                        )\r\n                    })\r\n\r\n                    const convoResolved = await Promise.all(convoPromises)\r\n                    const cuResolved = await Promise.all(cuPromises)\r\n\r\n                    // Loop through each conversation the logged in user is a part of\r\n                    // to create a ClientConversation for each conversation.\r\n                    userConversationsOnce.forEach((uc) => {\r\n                        if (!uc.key) {\r\n                            return\r\n                        }\r\n                        const convo: ClientConversation = {\r\n                            id: uc.key,\r\n                            otherUsers: [],\r\n                            name: '',\r\n                        }\r\n                        // Check if conversation keys match\r\n                        const matchedConversation = convoResolved.find(\r\n                            (cor) => cor.ref.key === uc.key\r\n                        )\r\n                        const matchedConversationUsers = cuResolved.find(\r\n                            (cur) => cur.ref.key === uc.key\r\n                        )\r\n\r\n                        // Add name to convo\r\n                        if (matchedConversation) {\r\n                            convo.name = matchedConversation.val().name\r\n                        }\r\n\r\n                        // Add other users to the ClientConversation.\r\n                        if (matchedConversationUsers) {\r\n                            matchedConversationUsers.forEach(\r\n                                (conversationUser) => {\r\n                                    if (\r\n                                        conversationUser.key &&\r\n                                        conversationUser.key !== userId\r\n                                    ) {\r\n                                        convo.otherUsers.push({\r\n                                            id: conversationUser.key,\r\n                                            userName: conversationUser\r\n                                                .child('userName')\r\n                                                .val(),\r\n                                        })\r\n                                    }\r\n                                }\r\n                            )\r\n                        }\r\n\r\n                        initialConversations.push(convo)\r\n                    })\r\n\r\n                    setConversations(initialConversations)\r\n\r\n                    lastInitialUserConversationId =\r\n                        initialConversations.length > 0\r\n                            ? initialConversations[\r\n                                  initialConversations.length - 1\r\n                              ].id\r\n                            : ''\r\n                } else {\r\n                    setConversations([])\r\n                    setConversationId(null)\r\n                }\r\n\r\n                userConversationsRef\r\n                    .orderByKey()\r\n                    .startAfter(lastInitialUserConversationId)\r\n                    .on(\r\n                        'child_added',\r\n                        (userConversationSnapshot, previousChildKey) => {\r\n                            // userConversationSnapshot.key is a new conversation key\r\n                            const ucKey = userConversationSnapshot.key\r\n                            if (!ucKey) {\r\n                                return\r\n                            }\r\n                            const convo: ClientConversation = {\r\n                                id: ucKey,\r\n                                otherUsers: [],\r\n                                name: '',\r\n                            }\r\n                            db.ref(`conversations/${ucKey}`)\r\n                                .orderByKey()\r\n                                .once('value')\r\n                                .then((conversation) => {\r\n                                    convo.name = conversation.val().name\r\n                                    db.ref(`conversationUsers/${ucKey}`)\r\n                                        .orderByKey()\r\n                                        .once('value')\r\n                                        .then((newConversationUsers) => {\r\n                                            newConversationUsers.forEach(\r\n                                                (ncu) => {\r\n                                                    if (\r\n                                                        ncu.key &&\r\n                                                        ncu.key !== userId\r\n                                                    ) {\r\n                                                        convo.otherUsers.push({\r\n                                                            id: ncu.key,\r\n                                                            userName: ncu\r\n                                                                .child(\r\n                                                                    'userName'\r\n                                                                )\r\n                                                                .val(),\r\n                                                        })\r\n                                                    }\r\n                                                }\r\n                                            )\r\n                                            setConversations((prev) => [\r\n                                                ...prev,\r\n                                                convo,\r\n                                            ])\r\n                                        })\r\n                                })\r\n                        }\r\n                    )\r\n            })()\r\n\r\n            return () => {\r\n                userConversationsRef.off('child_added')\r\n            }\r\n        } catch (e) {\r\n            console.error(e)\r\n            return\r\n        }\r\n    }, [initialized, userId])\r\n\r\n    /**\r\n     * Pulls messages, and listens to new ones.\r\n     */\r\n    useEffect(() => {\r\n        try {\r\n            if (!initialized || !userId || !conversationId) {\r\n                return\r\n            }\r\n\r\n            const db = firebase.database()\r\n            const messagesRefString = `messages/${conversationId}`\r\n            const messagesRef = db.ref(messagesRefString)\r\n\r\n            ;(async () => {\r\n                const messagesOnce = await messagesRef\r\n                    .orderByKey()\r\n                    .once('value')\r\n                const initialMessages: ClientMessage[] = []\r\n\r\n                if (messagesOnce.exists()) {\r\n                    messagesOnce.forEach((m) => {\r\n                        if (m.key) {\r\n                            const serverMessage = m.toJSON() as ServerMessage\r\n                            initialMessages.push({\r\n                                ...serverMessage,\r\n                                id: m.key,\r\n                            })\r\n                        }\r\n                    })\r\n                    setMessages(initialMessages)\r\n                } else {\r\n                    setMessages([])\r\n                }\r\n\r\n                const lastInitialMessageId: string =\r\n                    initialMessages.length > 0\r\n                        ? initialMessages[initialMessages.length - 1].id\r\n                        : ''\r\n                messagesRef\r\n                    .orderByKey()\r\n                    .startAfter(lastInitialMessageId)\r\n                    .on('child_added', (messageSnapshot, previousChildKey) => {\r\n                        if (messageSnapshot.key) {\r\n                            const serverMessage = messageSnapshot.toJSON() as ServerMessage\r\n                            const clientMessage: ClientMessage = {\r\n                                ...serverMessage,\r\n                                id: messageSnapshot.key,\r\n                            }\r\n                            setMessages((prev) => [...prev, clientMessage])\r\n                        }\r\n                    })\r\n            })()\r\n\r\n            return () => {\r\n                messagesRef.off('child_added')\r\n            }\r\n        } catch (e) {\r\n            console.error(e)\r\n        }\r\n    }, [initialized, userId, conversationId])\r\n\r\n    return {\r\n        messages,\r\n        conversations,\r\n        conversationId,\r\n        setConversationId,\r\n    }\r\n}\r\n","import * as React from 'react'\r\nimport firebase from 'firebase'\r\nimport {\r\n    ServerUserStatus,\r\n    ClientUserStatuses,\r\n} from '../../__shared__/types/userStatus'\r\nimport { ClientUser } from '../../__shared__/types/user'\r\n\r\nexport function useUsers(\r\n    initialized: boolean,\r\n    userId: string | undefined\r\n): [ClientUser[], ClientUserStatuses] {\r\n    const [statuses, setStatuses] = React.useState<ClientUserStatuses>({})\r\n    const [users, setUsers] = React.useState<ClientUser[]>([])\r\n\r\n    /**\r\n     * Updates the logged-in user's status in the database.\r\n     */\r\n    React.useEffect(() => {\r\n        if (!initialized || !userId) {\r\n            return\r\n        }\r\n\r\n        const db = firebase.database()\r\n        const userStatusDatabaseRef = db.ref('/status/' + userId)\r\n        const infoConnectedRef = db.ref('.info/connected')\r\n\r\n        // The below is from firebase docs\r\n\r\n        const isOfflineForDatabase: ServerUserStatus = {\r\n            state: 'offline',\r\n            lastChanged: firebase.database.ServerValue.TIMESTAMP,\r\n        }\r\n\r\n        const isOnlineForDatabase: ServerUserStatus = {\r\n            state: 'online',\r\n            lastChanged: firebase.database.ServerValue.TIMESTAMP,\r\n        }\r\n\r\n        // Create a reference to the special '.info/connected' path in\r\n        // Realtime Database. This path returns `true` when connected\r\n        // and `false` when disconnected.\r\n        infoConnectedRef.on('value', function (snapshot) {\r\n            // If we're not currently connected, don't do anything.\r\n            if (!snapshot.val()) {\r\n                return\r\n            }\r\n\r\n            // If we are currently connected, then use the 'onDisconnect()'\r\n            // method to add a set which will only trigger once this\r\n            // client has disconnected by closing the app,\r\n            // losing internet, or any other means.\r\n            userStatusDatabaseRef\r\n                .onDisconnect()\r\n                .set(isOfflineForDatabase)\r\n                .then(function () {\r\n                    // The promise returned from .onDisconnect().set() will\r\n                    // resolve as soon as the server acknowledges the onDisconnect()\r\n                    // request, NOT once we've actually disconnected:\r\n                    // https://firebase.google.com/docs/reference/js/firebase.database.OnDisconnect\r\n\r\n                    // We can now safely set ourselves as 'online' knowing that the\r\n                    // server will mark us as offline once we lose connection.\r\n                    userStatusDatabaseRef.set(isOnlineForDatabase)\r\n                })\r\n        })\r\n\r\n        return () => {\r\n            infoConnectedRef.off('value')\r\n        }\r\n    }, [initialized, userId])\r\n\r\n    /**\r\n     * Reads and listens to statuses for all users.\r\n     */\r\n    React.useEffect(() => {\r\n        if (!initialized) {\r\n            return\r\n        }\r\n\r\n        const db = firebase.database()\r\n        const statusRef = db.ref('/status')\r\n\r\n        ;(async () => {\r\n            let lastStatusKey = ''\r\n            const newStatuses: ClientUserStatuses = {}\r\n\r\n            const statusResolved = await db\r\n                .ref('/status')\r\n                .orderByKey()\r\n                .once('value')\r\n            statusResolved.forEach((data) => {\r\n                if (data.key) {\r\n                    lastStatusKey = data.key\r\n                    newStatuses[data.key] = {\r\n                        state: data.child('state').val(),\r\n                        lastChanged: data.child('lastChanged').val(),\r\n                    }\r\n                }\r\n            })\r\n            setStatuses(newStatuses)\r\n\r\n            statusRef.startAfter(lastStatusKey).on('child_added', (data) => {\r\n                const key = data.key\r\n                if (key) {\r\n                    setStatuses((prev) => ({\r\n                        ...prev,\r\n                        [key]: {\r\n                            state: data.child('state').val(),\r\n                            lastChanged: data.child('lastChanged').val(),\r\n                        },\r\n                    }))\r\n                }\r\n            })\r\n\r\n            statusRef.on('child_changed', (data) => {\r\n                const key = data.key\r\n                if (key) {\r\n                    setStatuses((prev) => ({\r\n                        ...prev,\r\n                        [key]: {\r\n                            state: data.child('state').val(),\r\n                            lastChanged: data.child('lastChanged').val(),\r\n                        },\r\n                    }))\r\n                }\r\n            })\r\n        })()\r\n\r\n        return () => {\r\n            statusRef.off('child_added')\r\n            statusRef.off('child_changed')\r\n        }\r\n    }, [initialized])\r\n\r\n    /**\r\n     * Reads and listens to users.\r\n     */\r\n    React.useEffect(() => {\r\n        if (!initialized) {\r\n            return\r\n        }\r\n\r\n        const db = firebase.database()\r\n        const usersRef = db.ref('/users')\r\n\r\n        ;(async () => {\r\n            let lastUserKey = ''\r\n            const newUsers: ClientUser[] = []\r\n\r\n            const usersResolved = await db\r\n                .ref('/users')\r\n                .orderByKey()\r\n                .once('value')\r\n            usersResolved.forEach((data) => {\r\n                if (data.key) {\r\n                    lastUserKey = data.key\r\n                    newUsers.push({\r\n                        id: data.key,\r\n                        userName: data.child('userName').val(),\r\n                        photoURL: data.child('photoURL').val(),\r\n                    })\r\n                }\r\n            })\r\n            setUsers(newUsers)\r\n\r\n            usersRef.startAfter(lastUserKey).on('child_added', (data) => {\r\n                const key = data.key\r\n                if (key) {\r\n                    setUsers((prev) => [\r\n                        ...prev,\r\n                        {\r\n                            id: key,\r\n                            userName: data.child('userName').val(),\r\n                            photoURL: data.child('photoURL').val(),\r\n                        },\r\n                    ])\r\n                }\r\n            })\r\n\r\n            usersRef.on('child_changed', (data) => {\r\n                const key = data.key\r\n                if (key) {\r\n                    setUsers((prev) => {\r\n                        const newUsers = [...prev]\r\n                        const changedUser = newUsers.find(\r\n                            (user) => user.id === key\r\n                        )\r\n                        if (changedUser) {\r\n                            changedUser.userName = data.child('userName').val()\r\n                            changedUser.photoURL = data.child('photoURL').val()\r\n                        }\r\n                        return newUsers\r\n                    })\r\n                }\r\n            })\r\n        })()\r\n\r\n        return () => {\r\n            usersRef.off('child_added')\r\n            usersRef.off('child_changed')\r\n        }\r\n    }, [initialized])\r\n\r\n    return [users, statuses]\r\n}\r\n","import { useState, useEffect } from 'react'\r\n\r\nexport type WindowSize = 'xs' | 'sm' | 'md' | 'lg' | 'xl'\r\n\r\n// Initially based on https://usehooks.com/useWindowSize/\r\nexport function useWindowSize(): WindowSize | undefined {\r\n    const [windowSize, setWindowSize] = useState<WindowSize | undefined>(() => {\r\n        return calculateWindowSize(window.innerWidth)\r\n    })\r\n\r\n    function calculateWindowSize(windowWidth: number): WindowSize {\r\n        if (windowWidth >= 1920) {\r\n            return 'xl'\r\n        } else if (windowWidth >= 1280) {\r\n            return 'lg'\r\n        } else if (windowWidth >= 960) {\r\n            return 'md'\r\n        } else if (windowWidth >= 700) {\r\n            return 'sm'\r\n        } else {\r\n            return 'xs'\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        function handleResize() {\r\n            const width = window.innerWidth\r\n            setWindowSize(calculateWindowSize(width))\r\n        }\r\n\r\n        window.addEventListener('resize', handleResize)\r\n\r\n        handleResize()\r\n\r\n        return () => window.removeEventListener('resize', handleResize)\r\n    }, [])\r\n\r\n    return windowSize\r\n}\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://cra.link/PWA\r\n\r\nconst isLocalhost = Boolean(\r\n    window.location.hostname === 'localhost' ||\r\n        // [::1] is the IPv6 localhost address.\r\n        window.location.hostname === '[::1]' ||\r\n        // 127.0.0.0/8 are considered localhost for IPv4.\r\n        window.location.hostname.match(\r\n            /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n        )\r\n)\r\n\r\ntype Config = {\r\n    onSuccess?: (registration: ServiceWorkerRegistration) => void\r\n    onUpdate?: (registration: ServiceWorkerRegistration) => void\r\n}\r\n\r\nexport function register(config?: Config) {\r\n    if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n        // The URL constructor is available in all browsers that support SW.\r\n        const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\r\n        if (publicUrl.origin !== window.location.origin) {\r\n            // Our service worker won't work if PUBLIC_URL is on a different origin\r\n            // from what our page is served on. This might happen if a CDN is used to\r\n            // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n            return\r\n        }\r\n\r\n        window.addEventListener('load', () => {\r\n            const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\r\n\r\n            if (isLocalhost) {\r\n                // This is running on localhost. Let's check if a service worker still exists or not.\r\n                checkValidServiceWorker(swUrl, config)\r\n\r\n                // Add some additional logging to localhost, pointing developers to the\r\n                // service worker/PWA documentation.\r\n                navigator.serviceWorker.ready.then(() => {\r\n                    console.log(\r\n                        'This web app is being served cache-first by a service ' +\r\n                            'worker. To learn more, visit https://cra.link/PWA'\r\n                    )\r\n                })\r\n            } else {\r\n                // Is not localhost. Just register service worker\r\n                registerValidSW(swUrl, config)\r\n            }\r\n        })\r\n    }\r\n}\r\n\r\nfunction registerValidSW(swUrl: string, config?: Config) {\r\n    navigator.serviceWorker\r\n        .register(swUrl)\r\n        .then((registration) => {\r\n            registration.onupdatefound = () => {\r\n                const installingWorker = registration.installing\r\n                if (installingWorker == null) {\r\n                    return\r\n                }\r\n                installingWorker.onstatechange = () => {\r\n                    if (installingWorker.state === 'installed') {\r\n                        if (navigator.serviceWorker.controller) {\r\n                            // At this point, the updated precached content has been fetched,\r\n                            // but the previous service worker will still serve the older\r\n                            // content until all client tabs are closed.\r\n                            console.log(\r\n                                'New content is available and will be used when all ' +\r\n                                    'tabs for this page are closed. See https://cra.link/PWA.'\r\n                            )\r\n\r\n                            // Execute callback\r\n                            if (config && config.onUpdate) {\r\n                                config.onUpdate(registration)\r\n                            }\r\n                        } else {\r\n                            // At this point, everything has been precached.\r\n                            // It's the perfect time to display a\r\n                            // \"Content is cached for offline use.\" message.\r\n                            console.log('Content is cached for offline use.')\r\n\r\n                            // Execute callback\r\n                            if (config && config.onSuccess) {\r\n                                config.onSuccess(registration)\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        })\r\n        .catch((error) => {\r\n            console.error('Error during service worker registration:', error)\r\n        })\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\r\n    // Check if the service worker can be found. If it can't reload the page.\r\n    fetch(swUrl, {\r\n        headers: { 'Service-Worker': 'script' },\r\n    })\r\n        .then((response) => {\r\n            // Ensure service worker exists, and that we really are getting a JS file.\r\n            const contentType = response.headers.get('content-type')\r\n            if (\r\n                response.status === 404 ||\r\n                (contentType != null &&\r\n                    contentType.indexOf('javascript') === -1)\r\n            ) {\r\n                // No service worker found. Probably a different app. Reload the page.\r\n                navigator.serviceWorker.ready.then((registration) => {\r\n                    registration.unregister().then(() => {\r\n                        window.location.reload()\r\n                    })\r\n                })\r\n            } else {\r\n                // Service worker found. Proceed as normal.\r\n                registerValidSW(swUrl, config)\r\n            }\r\n        })\r\n        .catch(() => {\r\n            console.log(\r\n                'No internet connection found. App is running in offline mode.'\r\n            )\r\n        })\r\n}\r\n\r\nexport function unregister() {\r\n    if ('serviceWorker' in navigator) {\r\n        navigator.serviceWorker.ready\r\n            .then((registration) => {\r\n                registration.unregister()\r\n            })\r\n            .catch((error) => {\r\n                console.error(error.message)\r\n            })\r\n    }\r\n}\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport './index.css'\r\nimport App from './components/App'\r\nimport * as serviceWorkerRegistration from './serviceWorkerRegistration'\r\nimport reportWebVitals from './reportWebVitals'\r\n\r\nReactDOM.render(\r\n    <React.StrictMode>\r\n        <App />\r\n    </React.StrictMode>,\r\n    document.getElementById('root')\r\n)\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://cra.link/PWA\r\nserviceWorkerRegistration.register()\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals()\r\n"],"sourceRoot":""}